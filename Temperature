package lab3;

import java.io.*;
import java.net.*;
import java.util.*;

//returns the temperature if valid zip code is passed in or if not it returns -1

public class getTempByZip {  
	public static int getTemperature(String zip)  {
			StringBuffer buffer = new StringBuffer();
			WebPageGetter pageOne = new WebPageGetter();
			String theUrl = "https://www.bing.com/search?q=" + zip + "+weather&form=EDGEAR&qs=WA&cvid=8921203ba63844f99e376494cc5fe5f6&pq=" + zip + "%20weather";
	    		
	    	try {
		         URL gotoUrl = new URL(theUrl);
		         InputStreamReader isr = new InputStreamReader(gotoUrl.openStream());
		         BufferedReader inStream = new BufferedReader(isr);		            
		         String inputLine;
		         
		         while ((inputLine = inStream.readLine()) != null && !buffer.toString().contains("on Bing")){
		        	 buffer.append(inputLine + "\n");
		         }
		            	  
		         for (int i = buffer.indexOf("on Bing"); i < buffer.indexOf("on Bing") + 20; i++){  
		         /*
		         To whoever is looking at this, I couldn't decide if this should be another for loop rather than a long if, not sure how it affects efficiency, leaving it like this for now...
		         */
		         
		        	 if (buffer.charAt(i) == '0' || buffer.charAt(i) == '1' ||buffer.charAt(i) == '2' ||buffer.charAt(i) == '3' ||buffer.charAt(i) == '4' ||buffer.charAt(i) == '5' ||buffer.charAt(i) == '6' ||buffer.charAt(i) == '7' ||buffer.charAt(i) == '8' ||buffer.charAt(i) == '9'){
		        		 return (10 * Character.getNumericValue(buffer.charAt(i)) + Character.getNumericValue(buffer.charAt(i + 1)));
		        	 }		         
		         }
		          
	    	} catch (IOException e) {
	    		e.printStackTrace();
	    	}	
	    	return -1;
	    }      
}


