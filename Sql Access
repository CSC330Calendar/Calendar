package lab3;

import java.sql.*;

public class SqlAccess {

	public SqlAccess() {
		// TODO Auto-generated constructor stub
	}

	/**
	 * @param args
	 */
	public static void main(String[] args) {
	SqlAccess one = new SqlAccess();
	one.query(" ");
	}
	
	public static String query(String query){

		String url = "jdbc:mysql://localhost/world?user=root&password=6815"; 
		
		Connection connection = null;
		Statement statement = null;
		ResultSet resultSet = null; 

		//query = "select username from calendar.friend";
		String field3 = new String();
		try {
			
			connection = DriverManager.getConnection(url);
			statement = connection.createStatement() ;
			
			resultSet = statement.executeQuery( query );
			 
			while(resultSet.next()) {
				field3 = resultSet.getString(1); // get 3rd field of the result set record. 
				//System.out.println(field3);
			}
			
		}
		catch(SQLException ex ) {
			System.err.println("DB Exception: " + ex); 
		}
		finally {
			try {
				if(statement != null ) statement.close(); 
				if(connection != null) connection.close(); 
				if(resultSet != null) resultSet.close(); 
			}
			catch(SQLException ex ) {} 
			
		}
		
		return field3;
	}
	
	public static void insert(String query){

		String url = "jdbc:mysql://localhost/world?user=root&password=6815"; 
		
		Connection connection = null;
		Statement statement = null;
		ResultSet resultSet = null; 

		//query = "select username from calendar.friend";
		String field3 = new String();
		try {
			
			connection = DriverManager.getConnection(url);
			statement = connection.createStatement() ;
			
			statement.execute( query );
			 
			
		}
		catch(SQLException ex ) {
			System.err.println("DB Exception: " + ex); 
		}
		finally {
			try {
				if(statement != null ) statement.close(); 
				if(connection != null) connection.close(); 
				if(resultSet != null) resultSet.close(); 
			}
			catch(SQLException ex ) {} 
			
		}
		
	}
}
